\documentclass[thesis.tex]{subfiles}

\begin{document}
\chapter{The "birthday problem" and context lengths}
\label{sec:birthday_problem}
The "birthday problem" is the problem of deciding the probability $B(n)$ that two people in a group of $n$ share a birthday. We can let $B'(n)$ represent the opposing probability, that there is noone amongst the $n$ which share birthdays. As the two are both exhaustive and exclusive we know that $B(n)+B'(n)=1$ and thus that $B(n)=1-B'(n)$.\\
\par\noindent
Deciding the probability that noone is sharing a birthday can be broken down to the individual people making up the selection. When we add a person to the selection we multiply the probability for the previous selection with the probability that the given person does not share a birthday, which is given by the probability of selecting an available day from the total number of days, $365$. As we already know we are not interested in selections where two people share birthdays, the available days are equal to $365$ minus the number of people in the selection, $n-1$. The total result for a group of $n$ people is thus given by the formula:
\begin{equation}
	B'(n)=\dfrac{365-0}{365} * \dfrac{365-1}{365} * \dfrac{365-2}{365} * ... * \dfrac{365-(n-2)}{365} * \dfrac{365-(n-1)}{365}
\end{equation}
which can be approximated using taylor series \cite{understanding_the_birthday_problem}:
\begin{equation}
	B'(n)=e^{-(n^2/(2*365))}
\end{equation}
which gives:
\begin{equation}
	B(n)=1-e^{-(n^2/(2*365))}
\end{equation}
Conveniently, we can apply the approximations used in the birthday problem to determine the probability of contexts being shared by two or more vertices. We let the number of actual contexts $x$ replace the number of people, and the number of possible contexts $y$ replace the days of the year. $y$ is easily calculated by $4^{|c|}$, which is the number of all possible strings over the alphabet $\{A, C, G, T\}$.
\begin{equation}
	y=4^{|c|}
\end{equation}
Computing $x$ requires more work, so we chose to do another approximation to avoid complex calculations. We let $b$ be the branching factor, such that every vertice has approximately $b$ neighbours. Every one of these neighbours has approximately $b$ neighbours again, and so on for every one of the $|c|$ vertices which make up a context. This leads $b^{|c|}$ contexts for each vertice and $|G|b^{|c|}$ total contexts. If we assume our graphs are mostly linear we can set $b=1$ to end up with a total of $|G|$ contexts. 
\begin{equation}
	x=|G|
\end{equation}
Plugging these values into the previous formula we search for the smallest context length $|c|$ which gives us less than $1\%$ probability of shared contexts\\
\begin{equation}
|c|=\underset{c}{min} (1-e^{-|G|^2/2*4^c} < 0.01)
\end{equation}
These approximations might seem crude, but as previously stated the length of the contexts does not affect the correctness of the final result and thus we are only trimming efficiency. The functions made by varying $|c|$ in the approximation seem to do a jump from values exponentially decreasing from $1$ to values logaritmically approaching $0$ (See fig. \ref{fig:context_lengths}). The values close to $1$ represent contexts with a low probability of overlap, which gives deep suffix trees. Values close to $0$ represent contexts with a lot of overlap, which gives high complexity in the search part done by the algorithm. A clear goal is to be a part of the ``jumping section'' as laying to close to either of the boundaries run a danger of overcompensating for the opposite effect. The somewhat arbitrarily chosen value $1\%$ was decided as a means to avoid bloated indexes at the cost of a small runtime increase.
\begin{figure}[!b]
  \begin{tikzpicture}
    \begin{axis}[scale only axis,height=0.5\textwidth,width=\textwidth,xmin=0,ymin=0,xmax=25,ymax=1,scaled ticks=false, legend style={legend pos=south west,font=\small}, legend cell align=left]
      \addplot[color=black, name path=50] coordinates {
        (1,1.0)
        (1.25,1.0)
        (1.5,1.0)
        (1.75,1.0)
        (2.0,1.0)
        (2.25,1.0)
        (2.5,1.0)
        (2.75,1.0)
        (3.0,1.0)
        (3.25,0.999999999999)
        (3.5,0.999999996706)
        (3.75,0.999998995157)
        (4.0,0.999942609111)
        (4.25,0.998997581461)
        (4.5,0.992424322556)
        (4.75,0.968339006034)
        (5.0,0.912961632344)
        (5.25,0.822064635426)
        (5.5,0.704977343826)
        (5.75,0.578176145087)
        (6.0,0.456840119141)
        (6.25,0.350520319861)
        (6.5,0.263006186689)
        (6.75,0.194096978453)
        (7.0,0.141516562005)
        (7.25,0.102278984569)
        (7.5,0.0734561866838)
        (7.75,0.0525185936224)
        (8.0,0.0374285411897)
        (8.25,0.0266134342525)
        (8.5,0.0188927383765)
        (8.75,0.0133964495566)
        (9.0,0.00949141264526)
        (9.25,0.00672080941793)
        (9.5,0.00475702094677)
        (9.75,0.00336606992233)
        (10.0,0.00238134587748)
        (10.25,0.00168445365322)
        (10.5,0.00119138263503)
        (10.75,0.000842581798653)
        (11.0,0.000595868847358)
        (11.25,0.000421379679744)
        (11.5,0.000297978819367)
        (11.75,0.000210712039654)
        (12.0,0.00014900051026)
        (12.25,0.000105361570357)
        (12.5,7.45030304806e-05)
        (12.75,5.26821728842e-05)
        (13.0,3.72522091039e-05)
        (13.25,2.63414333777e-05)
        (13.5,1.86262780211e-05)
        (13.75,1.31708034239e-05)
        (14.0,9.31318237818e-06)
        (14.25,6.58542339582e-06)
        (14.5,4.65660203108e-06)
        (14.75,3.29271711896e-06)
        (15.0,2.32830372604e-06)
        (15.25,1.64635991473e-06)
        (15.5,1.16415254059e-06)
        (15.75,8.2318029615e-07)
        (16.0,5.82076439715e-07)
        (16.25,4.11590232785e-07)
        (16.5,2.91038262268e-07)
        (16.75,2.05795137598e-07)
        (17.0,1.45519141737e-07)
        (17.25,1.02897574128e-07)
        (17.5,7.27595734773e-08)
        (17.75,5.14487883407e-08)
        (18.0,3.63797874048e-08)
        (18.25,2.57243945034e-08)
        (18.5,1.81898939244e-08)
        (18.75,1.28621973072e-08)
        (19.0,9.09494701773e-09)
        (19.25,6.43109865361e-09)
        (19.5,4.54747350886e-09)
        (19.75,3.21554938232e-09)
        (20.0,2.27373675443e-09)
        (20.25,1.60777469116e-09)
        (20.5,1.13686837722e-09)
        (20.75,8.03887290068e-10)
        (21.0,5.68434188608e-10)
        (21.25,4.01943700545e-10)
        (21.5,2.84217094304e-10)
        (21.75,2.00971794762e-10)
        (22.0,1.42108547152e-10)
        (22.25,1.00485952892e-10)
        (22.5,7.1054273576e-11)
        (22.75,5.02429209348e-11)
        (23.0,3.5527136788e-11)
        (23.25,2.51214604674e-11)
        (23.5,1.7763568394e-11)
        (23.75,1.25607302337e-11)
        (24.0,8.881784197e-12)
        (24.25,6.280420628e-12)
        (24.5,4.4408920985e-12)
        (24.75,3.14015480285e-12)
        (25.0,2.22044604925e-12)
      };
      \addplot[color=red, name path=500] coordinates {
        (1,1.0)
        (1.25,1.0)
        (1.5,1.0)
        (1.75,1.0)
        (2.0,1.0)
        (2.25,1.0)
        (2.5,1.0)
        (2.75,1.0)
        (3.0,1.0)
        (3.25,1.0)
        (3.5,1.0)
        (3.75,1.0)
        (4.0,1.0)
        (4.25,1.0)
        (4.5,1.0)
        (4.75,1.0)
        (5.0,1.0)
        (5.25,1.0)
        (5.5,1.0)
        (5.75,1.0)
        (6.0,1.0)
        (6.25,1.0)
        (6.5,1.0)
        (6.75,0.999999999575)
        (7.0,0.999999763848)
        (7.25,0.999979387095)
        (7.5,0.999514045)
        (7.75,0.995459856273)
        (8.0,0.977955612963)
        (8.25,0.932619411345)
        (8.5,0.851526476982)
        (8.75,0.740422287831)
        (9.0,0.614677378009)
        (9.25,0.490512304203)
        (9.5,0.379256395932)
        (9.75,0.286215931953)
        (10.0,0.21212716504)
        (10.25,0.155142575314)
        (10.5,0.112377988691)
        (10.75,0.0808387384763)
        (11.0,0.0578630612757)
        (11.25,0.0412710176887)
        (11.5,0.0293626121335)
        (11.75,0.0208529312145)
        (12.0,0.0147906882969)
        (12.25,0.0104813954323)
        (12.5,0.00742289382482)
        (12.75,0.00525450261503)
        (13.0,0.003718360013)
        (13.25,0.00263071162935)
        (13.5,0.00186091150231)
        (13.75,0.0013162220349)
        (14.0,0.000930889028347)
        (14.25,0.00065832771514)
        (14.5,0.000465552883918)
        (14.75,0.000329218049832)
        (15.0,0.000232803540703)
        (15.25,0.000164622575212)
        (15.5,0.000116408545826)
        (15.75,8.2314675459e-05)
        (16.0,5.82059668804e-05)
        (16.25,4.11581847276e-05)
        (16.5,2.91034069444e-05)
        (16.75,2.05793041177e-05)
        (17.0,1.45518093497e-05)
        (17.25,1.02897049978e-05)
        (17.5,7.27593114447e-06)
        (17.75,5.14486573377e-06)
        (18.0,3.63797218961e-06)
        (18.25,2.57243617563e-06)
        (18.5,1.8189877492e-06)
        (18.75,1.28621891493e-06)
        (19.0,9.09494288215e-07)
        (19.25,6.431096643e-07)
        (19.5,4.54747247525e-07)
        (19.75,3.21554883831e-07)
        (20.0,2.27373649575e-07)
        (20.25,1.60777454794e-07)
        (20.5,1.13686831282e-07)
        (20.75,8.03887306722e-08)
        (21.0,5.68434171955e-08)
        (21.25,4.01943661688e-08)
        (21.5,2.84217089863e-08)
        (21.75,2.00971832509e-08)
        (22.0,1.42108546042e-08)
        (22.25,1.00485917365e-08)
        (22.5,7.1054273576e-09)
        (22.75,5.02429586824e-09)
        (23.0,3.5527136788e-09)
        (23.25,2.51214793412e-09)
        (23.5,1.7763568394e-09)
        (23.75,1.25607391155e-09)
        (24.0,8.881784197e-10)
        (24.25,6.28036955774e-10)
        (24.5,4.4408920985e-10)
        (24.75,3.14018477887e-10)
        (25.0,2.22044604925e-10)
      };
      \addplot[color=blue, name path=5000] coordinates {
        (1,1.0)
        (1.25,1.0)
        (1.5,1.0)
        (1.75,1.0)
        (2.0,1.0)
        (2.25,1.0)
        (2.5,1.0)
        (2.75,1.0)
        (3.0,1.0)
        (3.25,1.0)
        (3.5,1.0)
        (3.75,1.0)
        (4.0,1.0)
        (4.25,1.0)
        (4.5,1.0)
        (4.75,1.0)
        (5.0,1.0)
        (5.25,1.0)
        (5.5,1.0)
        (5.75,1.0)
        (6.0,1.0)
        (6.25,1.0)
        (6.5,1.0)
        (6.75,1.0)
        (7.0,1.0)
        (7.25,1.0)
        (7.5,1.0)
        (7.75,1.0)
        (8.0,1.0)
        (8.25,1.0)
        (8.5,1.0)
        (8.75,1.0)
        (9.0,1.0)
        (9.25,1.0)
        (9.5,1.0)
        (9.75,1.0)
        (10.0,0.999999999956)
        (10.25,0.999999952319)
        (10.5,0.999993350234)
        (10.75,0.999781640922)
        (11.0,0.997421286061)
        (11.25,0.985223022018)
        (11.5,0.949218960831)
        (11.75,0.878439406131)
        (12.0,0.774653513075)
        (12.25,0.65134459151)
        (12.5,0.525293262187)
        (12.75,0.409529502439)
        (13.0,0.311010349996)
        (13.25,0.231579218422)
        (13.5,0.16994599573)
        (13.75,0.123403866323)
        (14.0,0.0889270038742)
        (14.25,0.0637328726921)
        (14.5,0.0454985614857)
        (14.75,0.0323910256163)
        (15.0,0.0230141052634)
        (15.25,0.0163288281221)
        (15.5,0.011574031737)
        (15.75,0.00819801780903)
        (16.0,0.00580385825383)
        (16.25,0.00410744445449)
        (16.5,0.0029061519866)
        (16.75,0.00205583545696)
        (17.0,0.00145413324505)
        (17.25,0.00102844657966)
        (17.5,0.000727331127808)
        (17.75,0.000514355570658)
        (18.0,0.000363731714284)
        (18.25,0.000257210864043)
        (18.5,0.000181882397745)
        (18.75,0.000128613702764)
        (19.0,9.09453343996e-05)
        (19.25,6.43089192005e-05)
        (19.5,4.54737011285e-05)
        (19.75,3.21549765715e-05)
        (20.0,2.27371090523e-05)
        (20.25,1.60776175306e-05)
        (20.5,1.1368619149e-05)
        (20.75,8.03884107681e-06)
        (21.0,5.68432573023e-06)
        (21.25,4.01942861628e-06)
        (21.5,2.84216690405e-06)
        (21.75,2.00971632758e-06)
        (22.0,1.42108446177e-06)
        (22.25,1.00485866872e-06)
        (22.5,7.10542483295e-07)
        (22.75,5.02429460592e-07)
        (23.0,3.55271304819e-07)
        (23.25,2.51214761882e-07)
        (23.5,1.77635668175e-07)
        (23.75,1.25607388823e-07)
        (24.0,8.88178379732e-08)
        (24.25,6.28036963546e-08)
        (24.5,4.44089199858e-08)
        (24.75,3.14018486769e-08)
        (25.0,2.22044602705e-08)
      };
      \addplot[color=green, name path=50000] coordinates {
        (1,1.0)
        (1.25,1.0)
        (1.5,1.0)
        (1.75,1.0)
        (2.0,1.0)
        (2.25,1.0)
        (2.5,1.0)
        (2.75,1.0)
        (3.0,1.0)
        (3.25,1.0)
        (3.5,1.0)
        (3.75,1.0)
        (4.0,1.0)
        (4.25,1.0)
        (4.5,1.0)
        (4.75,1.0)
        (5.0,1.0)
        (5.25,1.0)
        (5.5,1.0)
        (5.75,1.0)
        (6.0,1.0)
        (6.25,1.0)
        (6.5,1.0)
        (6.75,1.0)
        (7.0,1.0)
        (7.25,1.0)
        (7.5,1.0)
        (7.75,1.0)
        (8.0,1.0)
        (8.25,1.0)
        (8.5,1.0)
        (8.75,1.0)
        (9.0,1.0)
        (9.25,1.0)
        (9.5,1.0)
        (9.75,1.0)
        (10.0,1.0)
        (10.25,1.0)
        (10.5,1.0)
        (10.75,1.0)
        (11.0,1.0)
        (11.25,1.0)
        (11.5,1.0)
        (11.75,1.0)
        (12.0,1.0)
        (12.25,1.0)
        (12.5,1.0)
        (12.75,1.0)
        (13.0,1.0)
        (13.25,0.999999999996)
        (13.5,0.99999999186)
        (13.75,0.999998094736)
        (14.0,0.999909776961)
        (14.25,0.998619687119)
        (14.5,0.990501419125)
        (14.75,0.962847437754)
        (15.0,0.90253933678)
        (15.25,0.807250000659)
        (15.5,0.687813095694)
        (15.75,0.56096697238)
        (16.0,0.441263117106)
        (16.25,0.337404325686)
        (16.5,0.252512954698)
        (16.75,0.186000200053)
        (17.0,0.135426668638)
        (17.25,0.0977806253758)
        (17.5,0.0701756448868)
        (17.75,0.0501477090493)
        (18.0,0.0357259958325)
        (18.25,0.0253963416082)
        (18.5,0.0180254564565)
        (18.75,0.0127798328682)
        (19.0,0.00905371308859)
        (19.25,0.00641046345494)
        (19.5,0.00453714940666)
        (19.75,0.00321038501344)
        (20.0,0.00227115377306)
        (20.25,0.00160648290037)
        (20.5,0.00113622238719)
        (20.75,0.000803564307985)
        (21.0,0.000568272660502)
        (21.25,0.000401862900888)
        (21.5,0.000284176708452)
        (21.75,0.000200951641225)
        (22.0,0.000142098450211)
        (22.25,0.000100480868815)
        (22.5,7.10517492809e-05)
        (22.75,5.02416965216e-05)
        (23.0,3.55265057067e-05)
        (23.25,2.51211637973e-05)
        (23.5,1.77634106228e-05)
        (23.75,1.25606607837e-05)
        (24.0,8.88174475411e-06)
        (24.25,6.2803501133e-06)
        (24.5,4.44088223772e-06)
        (24.75,3.14017998704e-06)
        (25.0,2.22044358411e-06)
      };
      \addplot[color=yellow, name path=500000] coordinates {
        (1,1.0)
        (1.25,1.0)
        (1.5,1.0)
        (1.75,1.0)
        (2.0,1.0)
        (2.25,1.0)
        (2.5,1.0)
        (2.75,1.0)
        (3.0,1.0)
        (3.25,1.0)
        (3.5,1.0)
        (3.75,1.0)
        (4.0,1.0)
        (4.25,1.0)
        (4.5,1.0)
        (4.75,1.0)
        (5.0,1.0)
        (5.25,1.0)
        (5.5,1.0)
        (5.75,1.0)
        (6.0,1.0)
        (6.25,1.0)
        (6.5,1.0)
        (6.75,1.0)
        (7.0,1.0)
        (7.25,1.0)
        (7.5,1.0)
        (7.75,1.0)
        (8.0,1.0)
        (8.25,1.0)
        (8.5,1.0)
        (8.75,1.0)
        (9.0,1.0)
        (9.25,1.0)
        (9.5,1.0)
        (9.75,1.0)
        (10.0,1.0)
        (10.25,1.0)
        (10.5,1.0)
        (10.75,1.0)
        (11.0,1.0)
        (11.25,1.0)
        (11.5,1.0)
        (11.75,1.0)
        (12.0,1.0)
        (12.25,1.0)
        (12.5,1.0)
        (12.75,1.0)
        (13.0,1.0)
        (13.25,1.0)
        (13.5,1.0)
        (13.75,1.0)
        (14.0,1.0)
        (14.25,1.0)
        (14.5,1.0)
        (14.75,1.0)
        (15.0,1.0)
        (15.25,1.0)
        (15.5,1.0)
        (15.75,1.0)
        (16.0,1.0)
        (16.25,1.0)
        (16.5,1.0)
        (16.75,0.999999998845)
        (17.0,0.999999521168)
        (17.25,0.999966020662)
        (17.5,0.999308022844)
        (17.75,0.994170820165)
        (18.0,0.973694541323)
        (18.25,0.923650934288)
        (18.5,0.83781042365)
        (18.75,0.723686653034)
        (19.0,0.597272329793)
        (19.25,0.474344840256)
        (19.5,0.365391719084)
        (19.75,0.274979200475)
        (20.0,0.203376951805)
        (20.25,0.148518467889)
        (20.5,0.107462578827)
        (20.75,0.0772424304778)
        (21.0,0.0552580134378)
        (21.25,0.0393972884057)
        (21.5,0.028021612091)
        (21.75,0.0198965811741)
        (22.0,0.0141103571347)
        (22.25,0.00999827332175)
        (22.5,0.00708024349131)
        (22.75,0.00501169520529)
        (23.0,0.00354641025852)
        (23.25,0.00250899513093)
        (23.5,0.00177478005137)
        (23.75,0.00125528543623)
        (24.0,0.000887784105996)
        (24.25,0.000627839809527)
        (24.5,0.000443990616832)
        (24.75,0.000313969193091)
        (25.0,0.000222019954846)
      };
      \addlegendentry{|G|=50}
      \addlegendentry{|G|=500}
      \addlegendentry{|G|=5000}
      \addlegendentry{|G|=50000}
      \addlegendentry{|G|=500000}
    \end{axis}
  \end{tikzpicture}
  \caption{The functions $y=B(|G|)$ provided by varying $x=|c|$ for different graph sizes}
  \label{fig:context_lengths}
\end{figure}
\end{document}